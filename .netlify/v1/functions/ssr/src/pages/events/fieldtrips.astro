---
import { getCollection } from "astro:content";
import { filterExternalEvents } from '../../utility/filters'
import { sortEventsByDate } from '../../utility/eventSorting'

import Layout from "../../layouts/Layout.astro";
import EmailLink from "../../components/EmailLink.astro";
import PhoneLink from "../../components/PhoneLink.astro";
import HeadingWithBackground from "../../components/HeadingWithBackground.astro";
import Event from "../../components/Event.astro";
import { roles} from '../../utility/constants';

const { fieldTripCoordinator } = roles;

const CURRENT_YEAR = '2026'

const allEvents = await getCollection("events");
const renderedEvents = await Promise.all(
	allEvents.map(async (event) => {
		const rendered = await event.render();
		return { ...rendered, slug: event.slug };
	})
);

// Filter for field trip events only
const fieldTripEvents = renderedEvents.filter((e) => {
	const isExternal = filterExternalEvents({host: e.remarkPluginFrontmatter.host});
	if (isExternal) {
		return false;
	}
	return e.remarkPluginFrontmatter.type === "Field Trip";
});

// Sort events into past and upcoming using utility function
const { upcomingEvents, pastEvents } = sortEventsByDate(fieldTripEvents);
---

<Layout subtitle="Field Trips">
	<HeadingWithBackground
		background="/assets/knudsensFarmIntro.jpg"
		backgroundPositionY="30%"
	>
		<h1>Field Trips</h1>
	</HeadingWithBackground>

	<p>Field trips are at the heart of the Alberta Palaeontological Society. There’s nothing quite like getting out onto the landscape to see where fossils are found and to better understand the ancient worlds they come from. We're incredibly lucky to live in a province surrounded by world-class palaeontological treasures, from sweeping badlands to marine deposits and Ice Age sites.</p>

	<p>Whether you're brand new to fossils or a seasoned collector, we invite you to join us in the field. Come explore Alberta’s deep past with us. Check out the trips below and sign up for your next adventure!</p>

	<h2>Registration and Payment</h2>

	<p>
		To register for a field trip, print off and fill out the <a href="/fieldTrips/2026/registration-fillable.pdf">sign up sheet</a
		>, then follow the instructions there.
	</p>

	<p>
		Continuing from previous years, you will be able to pay field trip fees by
		Interac E-transfer (Canada only). Follow directions on your bank’s
		online banking site or mobile app. Bank fees may apply. Payee is
		<EmailLink
			email="giftshop@albertapaleo.org"
		   subject={`Field Trip Fees for ${CURRENT_YEAR}`}
	 />. Please state in the message field: "Field Trip Fees for {CURRENT_YEAR}". Email
		a scan or photo of the completed registration form to
		<EmailLink email="giftshop@albertapaleo.org" />.
	</p>

	<h2>Upcoming Field Trips</h2>
	{upcomingEvents.length > 0 ? (
		upcomingEvents.map((event, index, allEvents) => {
			const { Content, slug } = event;
			return (
				<Event
					frontmatter={event.remarkPluginFrontmatter as any}
					last={index === allEvents.length - 1}
					showPermalink={true}
					slug={slug}
				>
					<Content />
				</Event>
			);
		})
	) : (
		<p>No upcoming field trips are currently scheduled. Check back soon for new dates!</p>
	)}

	<section>
		<h2>
			Forms
		</h2>
			<ul class="field-trip-forms-list">
				<li>
					<a href="/fieldTrips/2026/registration-fillable.pdf">{CURRENT_YEAR} Registration Form</a>
				</li>
				<li>
					<a href="/fieldTrips/2026/forms/APS_Adult_Waiver.pdf">
						Adult Waiver
					</a>
				</li>
				<li>
					<a href="/fieldTrips/2026/forms/APS_Minor_Waiver.pdf">
						Minor Waiver
					</a>
				</li>
				<li>
					<a href="/fieldTrips/2026/forms/APS_ER_ContactMedInfo.pdf">
						Medical and Emergency Contact Information
					</a>
				</li>
			</ul>
	</section>

	<h2>Field Trip Terms</h2>

	<p>Field trips are open to members only!</p>

	<p>
		All fees are due at the time of registration. Fees for trips are generally, $10.00, although please check the individual trip.
		Non-members and unaccompanied minors will not be allowed to attend field
		trips. All participants are required to have their membership in good
		standing. Any membership applications received after May 1, { CURRENT_YEAR } will
		not be reviewed and voted on by the Board of Directors until September,
		{ CURRENT_YEAR }. Therefore, if you are a non-member and would like to join be sure
		your application is received prior to May 1, {CURRENT_YEAR}. All participants will
		be required to read and sign a release form (waiver). Detailed
		information will be provided to all those registered shortly after the
		registration deadline. After the registration deadline no refunds will
		be given; however, you will receive the guide for the trip.
		Registrations are accepted on a first come first served basis so sign up
		early to avoid disappointment. For the {CURRENT_YEAR} field trips {fieldTripCoordinator.name} will be
		sending you the waiver and medical forms along with the trip
		information. This information will be sent to you via email. Please ensure that your email address is correct and legible when
		sending in registration forms. When you arrive at the meeting place
		please have all forms completed. All participants are required to have
		fully completed all waiver and medical forms in order to attend the
		trip. There will be no exceptions. All personal information is held in
		confidence and ultimately destroyed.
	</p>

	<h2>Trip Participant Responsibilities</h2>
	<ul>
		<li>
			It is understood that risk is inherent to some degree in outdoor
			activities. Before registering for a trip please ensure you
			understand the risks involved and are prepared to accept them.
		</li>

		<li>
			As a participant you are responsible for your own safety and
			equipment at all times
		</li>

		<li>
			Inform the trip leader of any medical conditions they should be
			aware of in an emergency
		</li>

		<li>
			Ensure that your previous experience, ability and fitness level are
			adequate for the trip
		</li>
	</ul>

	<h2>Important Safety Information</h2>
	<p>
		The APS is concerned about the safety of its members during our field
		tip outings. Safety protocol requires that the SAFETY GUIDELINES must be
		communicated to and understood by those attending. You will be asked to
		sign our waiver as proof of your understanding of these SAFETY
		GUIDELINES.
	</p>

	<h2>Questions?</h2>

	<p>
		Contact {fieldTripCoordinator.name}, the APS Fieldtrip Coordinator{fieldTripCoordinator.email && <> by e-mail at <EmailLink
			email={fieldTripCoordinator.email}
		/></>}{fieldTripCoordinator.telephone && <> or phone at <PhoneLink number={fieldTripCoordinator.telephone} /></>}.
	</p>

	
	{pastEvents.length > 0 && (
		<details>
			<summary><h2>Past Field Trips</h2></summary>
			{pastEvents.map((event, index, allEvents) => {
				const { Content, slug } = event;
				return (
					<Event
						frontmatter={event.remarkPluginFrontmatter as any}
						last={index === allEvents.length - 1}
						showPermalink={true}
						slug={slug}
					>
						<Content />
					</Event>
				);
			})}
		</details>
	)}
</Layout>

<style>
	summary h2 {
		display: inline;
	}

	ul.field-trip-forms-list {
		list-style: none;
		padding: 0;
		margin: 0;
	}
</style>


	<!-- <section> -->
	<!-- 	<h2> -->
	<!-- 		Dinovember 2025 Royal Tyrrell Museum Sleep-In! -->
	<!-- 	</h2> -->

	<!-- 	<p> -->
	<!-- 		The Alberta Palaeontological Society is excited to invite you to a special overnight event at the Royal Tyrrell Museum of Palaeontology in Drumheller, Alberta! -->
	<!-- 	</p> -->

	<!-- 	<p> -->
	<!-- 		<strong>Date</strong>: Friday, November 28 - Saturday, November 29 -->
	<!-- 	</p> -->

	<!-- 	<p> -->
	<!-- 		<strong> -->
	<!-- 			Itinerary -->
	<!-- 		</strong> -->
	<!-- 	</p> -->

	<!-- 	<ul> -->
	<!-- 		<li> -->
	<!-- 			<strong>Friday Evening</strong> -->
	<!-- 			<ul> -->
	<!-- 				<li>6:30 PM: Arrive at the museum</li> -->
	<!-- 				<li>Participate in fun palaeontology activities</li> -->
	<!-- 				<li>Enjoy snacks</li> -->
	<!-- 				<li>Lights out for the night</li> -->
	<!-- 			</ul> -->
	<!-- 		</li> -->
	<!-- 		<li><strong>Saturday Morning</strong> -->
	<!-- 			<ul> -->
	<!-- 				<li>Breakfast</li> -->
	<!-- 				<li>Explore the galleries!</li> -->
	<!-- 			</ul> -->
	<!-- 		</li> -->
	<!-- 	</ul> -->

	<!-- 	<strong>Price</strong>: $54 per person -->

	<!-- 	<p> -->
	<!-- 		Your ticket includes: -->
	<!-- 	</p> -->

<!-- <ul> -->
	<!-- <li>Evening Snacks &amp; Breakfast</li> -->
	<!-- <li>Palaeontology activities</li> -->
	<!-- <li>Full-day admission to the museum</li> -->
<!-- </ul> -->

<!-- <p> -->
	<!-- This is a fantastic event for kids &amp; families, but we require at least one adult per five children. Please note also that only children between <strong>5 - 13 years old</strong> and their adults are eligible to attend. Unfortunately, <strong>no unacompanied adults are allowed!</strong> -->
<!-- </p> -->

<!-- <p> -->
	<!-- <strong>Space is limited</strong> — we're only accepting the first 15 registrants, so don't delay! -->
<!-- </p> -->

<!-- <p> -->
	<!-- This program often fills up quickly, so the deadline for registration is <strong>Friday, October 24!</strong> -->
<!-- </p> -->

<!-- <p> -->
	<!-- <strong>Registration</strong>: Please see the <a href='/events/fieldtrips'>field trips page</a> on the APS website for more information on how to register. -->
<!-- </p> -->

<!-- <p> -->
	<!-- <strong>Additional Information</strong>: Visit <a href="https://www.tyrrellmuseum.com/whats_on/activities/camp-ins">Royal Tyrrell Museum Camp-Ins</a> for more details. -->
<!-- </p> -->

	<!-- <p> -->
	<!-- 	This is a rare opportunity during the winter months when palaeontology events are usually scarce, so invite friends and family who share your interest in ancient life. Even if they're not yet APS members, this could be the perfect introduction! -->
	<!-- </p> -->
	<!-- 	<p>To register, please fill out the <a href="/fieldTrips/2025/Dinovember Field Trip Sign Up-fillable.pdf">sign up sheet</a>.</p> -->
	<!-- </section> -->

	<!-- <hr /> -->

